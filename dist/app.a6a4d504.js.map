{"version":3,"sources":["src/constants.js","src/keyboards_events.js","src/history_management.js","src/utils.js","src/commands/command.js","src/commands/pan.js","src/commands/select.js","src/commands/line.js","src/commands/rect.js","src/commands/circle.js","src/commands/zoom.js","src/app.js","node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["CANVAS_DIMENSIONS","WIDTH","HEIGHT","SNAP_GRID","OPERATIONS","PAN","ZOOM","SELECT","DELETE","MOVE","ROTATE","PULL","SCALE","COPY","LINE","RECT","CIRCLE","ARC","FILL","TEXT","MEASURES","COLORS","shapes_fill","shapes_fill_selected","shapes_stroke","LINES","KeyboardEvents","main","choosenCommand","currentSnap","M","hasSnap","startListenDocumentKeyup","document","onkeyup","e","key","XL","L","S","XS","ctrlKey","HM","undo","redo","zoomLevel","HistoryManagement","history","position","value","length","slice","push","shapes","console","log","colorsTable","trackSelection","shape","r","Math","round","random","g","b","colorKey","Command","PanCommand","state","isMouseDown","startX","startY","netPanningX","netPanningY","x","_x","y","_y","dx","dy","mouse","event","SelectCommand","foundCoordinates","point","isSamePoint","pixel","gctx","getImageData","data","color","forEach","item","selected","theOneSelected","LineCommand","started","start","tempShape","start_x","start_y","end_x","end_y","set","RectCommand","width","height","min","w","abs","h","stroke","CircleCommand","radius","sqrt","ZoomCommand","mouseDown","window","onload","cad","WebCAD","getElementById","replaceWith","canvas","ctx","getContext","ghostcanvas","createElement","keys","commands","startListening","resizeCanvas","innerWidth","innerHeight","style","cursor","drawAll","addEventListener","bind","oncontextmenu","globalHandler","ev","preventDefault","stopPropagation","parseInt","clientX","clientY","restoH","restoV","currentCommand","func","type","requestAnimationFrame","loop","strokeStyle","strokeRect","lineWidth","setLineDash","beginPath","moveTo","lineTo","fillStyle","fillText","toUpperCase","closePath","fillRect","i","font","toString","hit","save","rect","fill","restore","arc","PI","scale","translate","drawCanvas","drawPointer","drawShapes","OVERLAY_ID","OldModule","module","bundle","Module","moduleName","call","hot","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","JSON","parse","handled","assets","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","id","every","generated","js","clear","hmrApply","v","hmrAcceptRun","reload","close","onclose","removeErrorOverlay","error","message","stack","overlay","createErrorOverlay","body","appendChild","remove","stackTrace","innerText","innerHTML","getParents","modules","parents","k","d","dep","Array","isArray","concat","Function","deps","cached","cache","some","cb"],"mappings":"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","file":"app.a6a4d504.js","sourceRoot":"..","sourcesContent":["export const CANVAS_DIMENSIONS = {\n    WIDTH: 4000,\n    HEIGHT: 3000\n}\n\nexport const SNAP_GRID = {\n    'XS': 5,\n    'S': 10,\n    'M': 20,\n    'L': 40,\n    'XL': 80\n};\n\nexport const OPERATIONS = {\n    // view\n    PAN: \"PAN\",\n    ZOOM: \"ZOOM\",\n    SELECT: \"SELECT\",\n    DELETE: \"DELETE\",\n    // MODIFICA\n    MOVE: 'MOVE',\n    ROTATE: \"ROTATE\",\n    PULL: \"PULL\",\n    SCALE: 'SCALE',\n    COPY: 'COPY',\n    // SHAPES\n    LINE: 'LINE',\n    RECT: 'RECT',\n    CIRCLE: 'CIRCLE',\n    ARC: 'ARC',\n    // STYLE\n    FILL: 'FILL',\n    // UTILS\n    TEXT: 'TEXT',\n    MEASURES: 'MEASURES'\n};\n\nexport const COLORS = {\n    shapes_fill: 'rgba(0,200,0,0.30)',\n    shapes_fill_selected: 'rgba(200,0,200,0.30)',\n    shapes_stroke: 'white',\n    LINES: 'grey'\n}","import { OPERATIONS, SNAP_GRID } from './constants';\n\n// https://css-tricks.com/snippets/javascript/javascript-keycodes/\nexport default class KeyboardEvents {\n\n    constructor(main) {\n\n        this.main = main;\n        // DEFAULTS\n        this.choosenCommand = OPERATIONS.SELECT\n        this.currentSnap = SNAP_GRID.M;\n        this.hasSnap = true;\n\n        this.startListenDocumentKeyup()\n    }\n\n    startListenDocumentKeyup() {\n        document.onkeyup = (e) => {\n            if (e.key == 'Escape' || e.key == 's') {\n                this.choosenCommand = OPERATIONS.SELECT;\n                /* } else if (e.key == 'd') {\n                    this.choosenCommand = OPERATIONS.DELETE;\n                } else if (e.key == 'c') {\n                    this.choosenCommand = OPERATIONS.COPY;\n                } else if (e.key == 'm') {\n                    this.choosenCommand = OPERATIONS.MOVE;\n                } else if (e.key == 'r') {\n                    this.choosenCommand = OPERATIONS.ROTATE;\n                } else if (e.key == 'p') {\n                    this.choosenCommand = OPERATIONS.PULL;\n                } else if (e.key == 's') {\n                    this.choosenCommand = OPERATIONS.SCALE;\n                } else if (e.key == 'l') {\n                    this.choosenCommand = OPERATIONS.LINE;\n                } else if (e.key == 'q') {\n                    this.choosenCommand = OPERATIONS.RECT;\n                } else if (e.key == 'o') {\n                    this.choosenCommand = OPERATIONS.CIRCLE;\n                } else if (e.key == 'a') {\n                    this.choosenCommand = OPERATIONS.ARC;\n                } else if (e.key == 'f') {\n                    this.choosenCommand = OPERATIONS.FILL; */\n            } else if (e.key == 'l') {\n                this.choosenCommand = OPERATIONS.LINE;\n            } else if (e.key == 'r') {\n                this.choosenCommand = OPERATIONS.RECT;\n            } else if (e.key == 'c') {\n                this.choosenCommand = OPERATIONS.CIRCLE;\n            } else if (e.key == 'p') {\n                this.choosenCommand = OPERATIONS.PAN;\n            } else if (e.key == 0) {\n                this.hasSnap = false;\n            } else if (e.key == \"1\") {\n                this.hasSnap = true;\n                this.currentSnap = SNAP_GRID.XL\n            } else if (e.key == \"2\") {\n                this.hasSnap = true;\n                this.currentSnap = SNAP_GRID.L\n            } else if (e.key == \"3\") {\n                this.hasSnap = true;\n                this.currentSnap = SNAP_GRID.M\n            } else if (e.key == \"4\") {\n                this.hasSnap = true;\n                this.currentSnap = SNAP_GRID.S\n            } else if (e.key == \"5\") {\n                this.hasSnap = true;\n                this.currentSnap = SNAP_GRID.XS\n            } else if (e.ctrlKey && e.key == 'z') {\n                this.main.HM.undo()\n            } else if (e.ctrlKey && e.key == 'y') {\n                this.main.HM.redo()\n            } else if (e.ctrlKey && e.key == 'x') {\n                this.main.zoomLevel = 1;\n            } /* else if (e.ctrlKey && e.key == '+') {\n                this.main.zoomLevel += 0.1;\n            } else if (e.ctrlKey && e.key == '-') {\n                this.main.zoomLevel -= 0.1;\n            } */ else if (e.key == 'x') {\n                this.choosenCommand = OPERATIONS.ZOOM;\n            }\n        }\n    }\n}","export default class HistoryManagement {\n\n    constructor(main) {\n        this.main = main\n        this.history = [[]];\n        this.position = 0;\n    }\n\n    get value () {\n        return this.history[this.position];\n    }\n\n    set (value) {\n        if (this.position < this.history.length - 1) {\n            this.history = this.history.slice(0, this.position + 1);\n        }\n        this.history.push([...value]);\n        this.position += 1;\n    }\n    \n    undo () {\n        if (this.position > 0) {\n            this.position--;\n            this.main.shapes = [...this.value];\n        } else {\n            console.log('No more undo ...')\n        }\n    }\n    \n    redo () {\n        if (this.position < this.history.length - 1) {\n            this.position++;\n            this.main.shapes = [...this.value];\n        } else {\n            console.log('No more redo ...')\n        }\n    }\n\n    // toString function to aid in illustrating\n    toString () {\n        console.log(\"Currnent Value: \", this.value)\n        console.log(\"History: \", this.history)\n        console.log(\"Position: \", this.position);\n    }\n}\n","export const colorsTable = {}\n\nexport function trackSelection (shape) {\n    const r = Math.round(Math.random() * 255);\n    const g = Math.round(Math.random() * 255);\n    const b = Math.round(Math.random() * 255);\n    let key = `rgb(${r},${g},${b})`;\n    shape.colorKey = key;\n    if (!(key in colorsTable)) {\n        colorsTable[key] = shape\n    }\n    return shape;\n}","export default class Command {\r\n\r\n    constructor(main){\r\n        // ref to main class istance\r\n        this.main = main;\r\n    }\r\n\r\n}","import Command from './command';\n\nexport default class PanCommand extends Command {\n\n    constructor(state) {\n        super(state)\n\n        // this.mouse drag related variables\n        this.isMouseDown = false;\n        this.startX, this.startY;\n        // the accumulated horizontal(X) & vertical(Y) panning the user has done in total\n        this.main.netPanningX = 0;\n        this.main.netPanningY = 0;\n    }\n\n    mousemove(e) {\n        let x = e._x;\n        let y = e._y;\n\n        // if the this.mouse is being dragged\n        if (this.isMouseDown) {\n            // dx & dy are the distance the this.mouse has moved since the last this.mousemove event\n            var dx = x - this.startX;\n            var dy = y - this.startY;\n\n            // reset the vars for next this.mousemove\n            this.startX = x;\n            this.startY = y;\n\n            // accumulate the net panning done\n            this.main.netPanningX += dx;\n            this.main.netPanningY += dy;\n            // console.clear()\n            // console.log(`Net change in panning: x:${this.main.netPanningX}px, y:${this.main.netPanningY}px`);\n        }\n\n        this.main.mouse.x = x;\n        this.main.mouse.y = y;\n        this.main.mouse.event = e;\n    }\n\n    mousedown(e) {\n        // calc the starting this.mouse X,Y for the drag\n        this.startX = e._x;\n        this.startY = e._y;\n\n        // set the isDragging flag\n        this.isMouseDown = true;\n    }\n\n    mouseup(e) {\n        // clear the isDragging flag\n        this.isMouseDown = false;\n    }\n\n    mouseout(e) {\n        // clear the isDragging flag\n        this.isMouseDown = false;\n    }\n\n}","import Command from './command';\nimport { colorsTable } from '../utils';\n\nexport default class SelectCommand extends Command {\n\n    constructor(state) {\n        super(state)\n        this.foundCoordinates = {}\n    }\n\n    mousemove (e) {\n        this.main.mouse.x = e._x;\n        this.main.mouse.y = e._y;\n        this.main.mouse.event = e;\n    }\n\n    isSamePoint (point) {\n        return this.foundCoordinates.x === point.x && this.foundCoordinates.y === point.y;\n    }\n\n    mousedown (e) {\n        let x = e._x - this.main.netPanningX;\n        let y = e._y - this.main.netPanningY;\n        if (!this.isSamePoint({ x, y })) {\n            // get pixel under cursor\n            const pixel = this.main.gctx.getImageData(x, y, 1, 1).data;\n            // create rgb color for that pixel\n            const color = `rgb(${pixel[0]},${pixel[1]},${pixel[2]})`;\n            // find a shape with the same colour\n            this.main.shapes.forEach(item => {\n                if (color === item.colorKey) {\n                    item.selected = true;\n                    this.main.theOneSelected = item;\n                    this.foundCoordinates = {...{ x, y }}\n                } else {\n                    item.selected = false;\n                }\n            });\n        }\n    }\n\n    mouseup (event) {\n    }\n\n    mouseout (event) {\n    }\n\n}","import Command from './command';\r\n\r\nimport { COLORS } from '../constants';\r\nimport {trackSelection} from '../utils'\r\n\r\nexport default class LineCommand extends Command {\r\n\r\n    constructor(state) {\r\n        super(state)\r\n        this.started = false;\r\n        this.start = {}\r\n    }\r\n\r\n    mousemove(event) {\r\n        this.main.mouse.x = event._x;\r\n        this.main.mouse.y = event._y;\r\n        this.main.mouse.event = event;\r\n\r\n        if (this.started) {\r\n            this.main.tempShape = [{\r\n                start_x: this.start.x,\r\n                start_y: this.start.y,\r\n                end_x: event._x - this.main.netPanningX,\r\n                end_y: event._y - this.main.netPanningY\r\n            }]\r\n        }\r\n    }\r\n\r\n    mousedown(event) {\r\n        this.start.x = event._x - this.main.netPanningX;\r\n        this.start.y = event._y - this.main.netPanningY;\r\n        this.started = true;\r\n    }\r\n\r\n    mouseup(event) {\r\n        if (this.started) {\r\n            this.started = false;\r\n            this.main.tempShape.length = 0;\r\n            this.main.shapes.push(trackSelection({\r\n                start_x: this.start.x,\r\n                start_y: this.start.y,\r\n                end_x: event._x - this.main.netPanningX,\r\n                end_y: event._y - this.main.netPanningY,\r\n                color: COLORS.shapes_stroke\r\n            }));\r\n            this.main.HM.set(this.main.shapes)\r\n        }\r\n    }\r\n\r\n    mouseout(event) {\r\n        if (this.started) {\r\n            this.started = false;\r\n            this.main.tempShape.length = 0;\r\n            this.main.shapes.push(trackSelection({\r\n                start_x: this.start.x,\r\n                start_y: this.start.y,\r\n                end_x: event._x - this.main.netPanningX,\r\n                end_y: event._y - this.main.netPanningY,\r\n                color: COLORS.shapes_stroke\r\n            }));\r\n            this.main.HM.set(this.main.shapes)\r\n        }\r\n    }\r\n\r\n}","import Command from './command';\n\nimport { COLORS } from '../constants';\nimport {trackSelection} from '../utils'\n\nexport default class RectCommand extends Command {\n\n    constructor(state) {\n        super(state)\n        this.started = false;\n        this.start = {}\n        this.x, this.y\n        this.width, this.height\n    }\n\n    mousemove(event) {\n        this.main.mouse.x = event._x;\n        this.main.mouse.y = event._y;\n        this.main.mouse.event = event;\n\n        if (this.started) {\n            this.x = Math.min(event._x, this.start.x),\n                this.y = Math.min(event._y, this.start.y),\n                this.w = Math.abs(event._x - this.start.x),\n                this.h = Math.abs(event._y - this.start.y);\n            if (!this.w || !this.h) {\n                return;\n            }\n            this.main.tempShape = [{\n                x: this.x - this.main.netPanningX,\n                y: this.y - this.main.netPanningY,\n                w: this.w,\n                h: this.h\n            }]\n        }\n\n    }\n\n    mousedown(event) {\n        this.start.x = event._x;\n        this.start.y = event._y;\n        this.started = true;\n    }\n\n    mouseup(event) {\n        if (this.started) {\n            this.started = false;\n            this.main.tempShape.length = 0;\n            this.main.shapes.push(trackSelection({\n                x: this.x - this.main.netPanningX,\n                y: this.y - this.main.netPanningY,\n                w: this.w,\n                h: this.h,\n                color: COLORS.shapes_fill,\n                stroke: COLORS.shapes_stroke\n            }));\n            this.main.HM.set(this.main.shapes)\n        }\n    }\n\n    mouseout(event) {\n        if (this.started) {\n            this.started = false;\n            this.main.tempShape.length = 0;\n            this.main.shapes.push(trackSelection({\n                x: this.x - this.main.netPanningX,\n                y: this.y - this.main.netPanningY,\n                w: this.w,\n                h: this.h,\n                color: COLORS.shapes_fill,\n                stroke: COLORS.shapes_stroke\n            }));\n            this.main.HM.set(this.main.shapes)\n        }\n    }\n\n}","import Command from './command';\r\n\r\nimport { COLORS } from '../constants';\r\nimport { trackSelection } from '../utils'\r\n\r\nexport default class CircleCommand extends Command {\r\n\r\n    constructor(state) {\r\n        super(state)\r\n        this.started = false;\r\n        this.start = {}\r\n        this.radius = 0\r\n    }\r\n\r\n    mousemove (event) {\r\n        this.main.mouse.x = event._x;\r\n        this.main.mouse.y = event._y;\r\n        this.main.mouse.event = event;\r\n\r\n        if (this.started) {\r\n            let dx = this.start.x - (event._x - this.main.netPanningX);\r\n            let dy = this.start.y - (event._y - this.main.netPanningY);\r\n            this.radius = Math.sqrt(dx * dx + dy * dy);\r\n            this.main.tempShape = [{\r\n                start_x: this.start.x,\r\n                start_y: this.start.y,\r\n                radius: this.radius\r\n            }]\r\n        }\r\n    }\r\n\r\n    mousedown (event) {\r\n        /* this.main.ctx.beginPath(); */\r\n        this.start.x = event._x - this.main.netPanningX;\r\n        this.start.y = event._y - this.main.netPanningY;\r\n        this.started = true;\r\n    }\r\n\r\n    mouseup (event) {\r\n        if (this.started) {\r\n            this.started = false;\r\n            this.main.tempShape.length = 0;\r\n            this.main.shapes.push(trackSelection({\r\n                start_x: this.start.x,\r\n                start_y: this.start.y,\r\n                radius: this.radius,\r\n                color: COLORS.shapes_fill,\r\n                stroke: COLORS.shapes_stroke\r\n            }));\r\n            this.main.HM.set(this.main.shapes)\r\n            this.radius = 0;\r\n        }\r\n    }\r\n\r\n    mouseout (event) {\r\n        if (this.started) {\r\n            this.started = false;\r\n            this.main.tempShape.length = 0;\r\n            this.main.shapes.push(trackSelection({\r\n                start_x: this.start.x,\r\n                start_y: this.start.y,\r\n                radius: this.radius,\r\n                color: COLORS.shapes_fill,\r\n                stroke: COLORS.shapes_stroke\r\n            }));\r\n            this.main.HM.set(this.main.shapes)\r\n            this.radius = 0;\r\n        }\r\n    }\r\n\r\n}","import Command from './command';\r\n\r\nexport default class ZoomCommand extends Command {\r\n\r\n    constructor(state) {\r\n        super(state)\r\n        this.main.zoomLevel = 1;\r\n        this.mouseDown = false;\r\n    }\r\n\r\n    mousemove(e) {\r\n        // console.log('Zoom: mousemove', e, this)\r\n        this.main.mouse.x = e._x;\r\n        this.main.mouse.y = e._y;\r\n        this.main.mouse.event = e;\r\n\r\n        if (this.mouseDown) {\r\n            if (!e.ctrlKey) {\r\n                this.main.zoomLevel += .005;\r\n            } else {\r\n                this.main.zoomLevel -= .005;\r\n            }\r\n        }\r\n    }\r\n\r\n    mousedown(e) {\r\n        // console.log('Zoom: mousedown', e, this)\r\n        this.mouseDown = true\r\n\r\n    }\r\n\r\n    mouseup(event) {\r\n        // console.log('Zoom: mouseup', event, this)\r\n        this.mouseDown = false;\r\n    }\r\n\r\n    mouseout(event) {\r\n        // console.log('Zoom: mouseout', event, this)\r\n        this.mouseDown = false;\r\n    }\r\n\r\n}","import KeyboardEvents from './keyboards_events';\r\nimport HistoryManagement from './history_management';\r\nimport { colorsTable } from './utils';\r\n\r\nimport { CANVAS_DIMENSIONS, COLORS } from './constants';\r\n\r\n// Commands\r\nimport PanCommand from './commands/pan';\r\nimport SelectCommand from './commands/select';\r\nimport LineCommand from './commands/line';\r\nimport RectCommand from './commands/rect';\r\nimport CircleCommand from './commands/circle';\r\nimport ZoomCommand from './commands/zoom';\r\n\r\nwindow.onload = () => {\r\n    const cad = new WebCAD();\r\n    document.getElementById('canvas').replaceWith(cad.canvas);\r\n    cad.start();\r\n    window.cad = cad;\r\n}\r\n\r\nexport class WebCAD {\r\n\r\n    constructor() {\r\n        this.canvas = document.getElementById(\"canvas\");\r\n        this.ctx = this.canvas.getContext('2d');\r\n\r\n        // ghost canvas for selection\r\n        this.ghostcanvas = document.createElement('canvas');;\r\n        this.gctx = this.ghostcanvas.getContext('2d');\r\n        this.keys = new KeyboardEvents(this);\r\n        this.colorsTable = colorsTable;\r\n\r\n        this.commands = {\r\n            'SELECT': new SelectCommand(this),\r\n            'PAN': new PanCommand(this),\r\n            'ZOOM': new ZoomCommand(this),\r\n            'LINE': new LineCommand(this),\r\n            'RECT': new RectCommand(this),\r\n            'CIRCLE': new CircleCommand(this),\r\n        }\r\n\r\n        this.mouse = {\r\n            x: 0,\r\n            y: 0,\r\n            event: null\r\n        };\r\n\r\n        this.shapes = [];\r\n        this.tempShape = []\r\n        this.HM = new HistoryManagement(this);\r\n\r\n        this.startListening()\r\n        this.resizeCanvas()\r\n    }\r\n\r\n    resizeCanvas () {\r\n        this.canvas.width = window.innerWidth;\r\n        this.canvas.height = window.innerHeight;\r\n        this.ghostcanvas.width = window.innerWidth;\r\n        this.ghostcanvas.height = window.innerHeight;\r\n        this.canvas.style.cursor = \"none\"\r\n        this.drawAll();\r\n    }\r\n\r\n    startListening () {\r\n        // resize the canvas to fill browser window dynamically\r\n        window.addEventListener('resize', this.resizeCanvas.bind(this), false);\r\n        this.canvas.oncontextmenu = () => false;\r\n        // this.canvas.addEventListener('click', this.globalHandler.bind(this), false);\r\n        this.canvas.addEventListener('mousemove', this.globalHandler.bind(this), false);\r\n        this.canvas.addEventListener('mousedown', this.globalHandler.bind(this), false);\r\n        this.canvas.addEventListener('mouseup', this.globalHandler.bind(this), false);\r\n        this.canvas.addEventListener('mouseout', this.globalHandler.bind(this), false);\r\n    }\r\n\r\n    globalHandler (ev) {\r\n        ev.preventDefault();\r\n        ev.stopPropagation();\r\n        let x = parseInt(ev.clientX);\r\n        let y = parseInt(ev.clientY);\r\n\r\n        /* ----------------- SNAP 2 GRID ----------------- */\r\n        if (this.keys.hasSnap) {\r\n            let restoH = x % this.keys.currentSnap;\r\n            if (restoH >= this.keys.currentSnap) {\r\n                x = x - restoH + this.keys.currentSnap\r\n            } else {\r\n                x -= restoH;\r\n            }\r\n            let restoV = y % this.keys.currentSnap;\r\n            if (restoV >= this.keys.currentSnap) {\r\n                y = y - restoV + this.keys.currentSnap\r\n            } else {\r\n                y -= restoV;\r\n            }\r\n        }\r\n        ev._x = x;\r\n        ev._y = y;\r\n\r\n        this.currentCommand = this.commands[this.keys.choosenCommand]\r\n        var func = this.currentCommand[ev.type].bind(this.currentCommand);\r\n        if (func) {\r\n            func(ev);\r\n        }\r\n    }\r\n\r\n    loop () {\r\n        this.drawAll();\r\n        requestAnimationFrame(() => {\r\n            this.loop()\r\n        });\r\n    }\r\n\r\n    start () {\r\n        this.loop();\r\n    }\r\n\r\n    /* --------------------------------------------------------- */\r\n\r\n    drawPointer () {\r\n        this.ctx.strokeStyle = \"rgb(0,103,28)\"; // green\r\n        this.ctx.strokeRect(this.mouse.x - 5 - this.netPanningX, this.mouse.y - 5 - this.netPanningY, 10, 10);\r\n        this.ctx.lineWidth = 0.5;\r\n        this.ctx.setLineDash([this.keys.currentSnap, this.keys.currentSnap]);   // https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/setLineDash\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(this.mouse.x - this.netPanningX, 0);\r\n        this.ctx.lineTo(this.mouse.x - this.netPanningX, this.mouse.y - 5 - this.netPanningY);\r\n        this.ctx.moveTo(this.mouse.x - this.netPanningX, this.mouse.y + 5 - this.netPanningY);\r\n        this.ctx.lineTo(this.mouse.x - this.netPanningX, CANVAS_DIMENSIONS.HEIGHT);\r\n        this.ctx.moveTo(0, this.mouse.y - this.netPanningY);\r\n        this.ctx.lineTo(this.mouse.x - 5 - this.netPanningX, this.mouse.y - this.netPanningY);\r\n        this.ctx.moveTo(this.mouse.x + 5 - this.netPanningX, this.mouse.y - this.netPanningY);\r\n        this.ctx.lineTo(CANVAS_DIMENSIONS.WIDTH, this.mouse.y - this.netPanningY);\r\n        this.ctx.stroke();\r\n        this.ctx.fillStyle = COLORS.LINES;\r\n        this.ctx.fillText(`${this.keys.choosenCommand.toUpperCase()}`, this.mouse.x + 12.5 - this.netPanningX, this.mouse.y - 4.5 - this.netPanningY)\r\n        this.ctx.fillText(`x: ${this.mouse.x - this.netPanningX} - y: ${this.mouse.y - this.netPanningY}`, this.mouse.x + 12.5 - this.netPanningX, this.mouse.y + 12.5 - this.netPanningY)\r\n        this.ctx.closePath();\r\n        this.ctx.setLineDash([]);\r\n    }\r\n\r\n    drawCanvas () {\r\n        this.ctx.fillStyle = \"rgb(31,40,49)\";\r\n        this.ctx.fillRect(0, 0, CANVAS_DIMENSIONS.WIDTH, CANVAS_DIMENSIONS.HEIGHT);\r\n        // colonne\r\n        for (let i = 0; i < CANVAS_DIMENSIONS.WIDTH; i += this.keys.currentSnap) {\r\n            if (this.keys.hasSnap) {\r\n                this.ctx.beginPath();\r\n                this.ctx.moveTo(i + 0.5, 0);\r\n                this.ctx.lineTo(i + 0.5, CANVAS_DIMENSIONS.HEIGHT);\r\n                if (i % 100 === 0) {\r\n                    this.ctx.strokeStyle = \"rgb(48,55,71)\";\r\n                } else {\r\n                    this.ctx.strokeStyle = \"rgb(36,45,56)\";\r\n                }\r\n                this.ctx.lineWidth = 0.5;\r\n                this.ctx.closePath()\r\n                this.ctx.stroke();\r\n            }\r\n            if (i % 100 === 0) {\r\n                this.ctx.font = \"11px Arial\";\r\n                this.ctx.fillStyle = COLORS.LINES;\r\n                // this.ctx.textAlign = \"center\";\r\n                this.ctx.fillText(i.toString(), i + 2.5, 10 - (this.netPanningY > 0 ? 0 : this.netPanningY));\r\n            }\r\n        }\r\n        // righe\r\n        for (let i = 0; i < CANVAS_DIMENSIONS.HEIGHT; i += this.keys.currentSnap) {\r\n            if (this.keys.hasSnap) {\r\n                this.ctx.beginPath();\r\n                this.ctx.moveTo(0, i + 0.5);\r\n                this.ctx.lineTo(CANVAS_DIMENSIONS.WIDTH, i + 0.5);\r\n                if (i % 100 === 0) {\r\n                    this.ctx.strokeStyle = \"rgb(48,55,71)\";\r\n                } else {\r\n                    this.ctx.strokeStyle = \"rgb(36,45,56)\";\r\n                }\r\n                this.ctx.lineWidth = 0.5;\r\n                this.ctx.closePath()\r\n                this.ctx.stroke();\r\n            }\r\n            if (i % 100 === 0) {\r\n                this.ctx.font = \"11px Arial\";\r\n                this.ctx.fillStyle = COLORS.LINES;\r\n                // this.ctx.textAlign = \"center\";\r\n                this.ctx.fillText(i.toString(), 2.5 - (this.netPanningX > 0 ? 0 : this.netPanningX), i - 2.5);\r\n            }\r\n        }\r\n    }\r\n\r\n    drawShapes (ctx, hit) {\r\n        [...this.HM.value, ...this.tempShape].forEach(item => {\r\n            if (item.w) {\r\n                ctx.save()\r\n                ctx.fillStyle = item.selected ? COLORS.shapes_fill_selected : (hit ? item.colorKey : item.color)\r\n                ctx.strokeStyle = hit ? item.colorKey : item.stroke\r\n                ctx.beginPath()\r\n                ctx.rect(item.x, item.y, item.w, item.h)\r\n                ctx.fill()\r\n                ctx.stroke()\r\n                ctx.restore()\r\n            } else if (item.radius) {\r\n                ctx.save()\r\n                ctx.strokeStyle = hit ? item.colorKey : item.stroke\r\n                ctx.fillStyle = item.selected ? COLORS.shapes_fill_selected : (hit ? item.colorKey : item.color)\r\n                ctx.beginPath()\r\n                // x, y, radius, startAngle, endAngle, antiClockwise = false by default\r\n                ctx.arc(item.start_x, item.start_y, item.radius, 0, 2 * Math.PI, false) // full circle\r\n                ctx.fill()\r\n                ctx.stroke()\r\n                ctx.restore()\r\n            } else {\r\n                ctx.save()\r\n                ctx.strokeStyle = item.selected ? COLORS.shapes_fill_selected : (hit ? item.colorKey : item.color)\r\n                ctx.beginPath()\r\n                ctx.moveTo(item.start_x, item.start_y)\r\n                ctx.lineTo(item.end_x, item.end_y)\r\n                ctx.closePath()\r\n                ctx.stroke()\r\n                ctx.restore()\r\n            }\r\n        });\r\n    }\r\n\r\n    drawAll () {\r\n        this.ctx.fillStyle = \"black\";\r\n        this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height); // CANVAS_DIMENSIONS.WIDTH, CANVAS_DIMENSIONS.HEIGHT\r\n\r\n        this.ctx.save();\r\n        this.ctx.scale(this.zoomLevel, this.zoomLevel); // apply scale\r\n        this.ctx.translate(this.netPanningX, this.netPanningY); // apply translation\r\n        this.drawCanvas();\r\n        this.drawPointer();\r\n        this.drawShapes(this.ctx, false);\r\n        this.ctx.restore();\r\n\r\n        this.gctx.fillStyle = \"black\";\r\n        this.gctx.fillRect(0, 0, this.ghostcanvas.width, this.ghostcanvas.height); // CANVAS_DIMENSIONS.WIDTH, CANVAS_DIMENSIONS.HEIGHT\r\n        this.gctx.save();\r\n        this.gctx.scale(this.zoomLevel, this.zoomLevel); // apply scale\r\n        this.gctx.translate(this.netPanningX, this.netPanningY); // apply translation\r\n        this.drawShapes(this.gctx, true);\r\n        this.gctx.restore();\r\n    }\r\n\r\n}\r\n\r\n\r\n\r\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel] ✨ Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel] 🚨  ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\">🚨</span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}