{"version":3,"sources":["src/constants.js","src/keyboards_events.js","src/history_management.js","src/commands/command.js","src/commands/pan.js","src/commands/select.js","src/commands/line.js","src/commands/rect.js","src/commands/circle.js","src/app.js","node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["CANVAS_DIMENSIONS","WIDTH","HEIGHT","SNAP_GRID","OPERATIONS","PAN","ZOOM","SELECT","DELETE","MOVE","ROTATE","PULL","SCALE","COPY","LINE","RECT","CIRCLE","ARC","FILL","COLORS","shapes_fill","shapes_stroke","KeyboardEvents","main","choosenCommand","currentSnap","M","hasSnap","startListenDocumentKeyup","document","onkeyup","e","key","L","S","XS","ctrlKey","HM","undo","redo","HistoryManagement","history","position","value","length","slice","push","shapes","console","log","Command","PanCommand","state","isDown","startX","startY","netPanningX","netPanningY","preventDefault","stopPropagation","x","_x","y","_y","dx","dy","clear","mouse","event","SelectCommand","LineCommand","started","start","tempShape","start_x","start_y","end_x","end_y","color","set","RectCommand","width","height","Math","min","w","abs","h","ctx","beginPath","stroke","CircleCommand","radius","sqrt","window","onload","cad","WebCAD","getElementById","replaceWith","canvas","getContext","keys","commands","startListening","resizeCanvas","innerWidth","innerHeight","style","cursor","drawAll","addEventListener","bind","globalHandler","ev","currentCommand","parseInt","clientX","clientY","restoH","restoV","func","type","requestAnimationFrame","loop","strokeStyle","strokeRect","lineWidth","moveTo","lineTo","fillStyle","fillText","toUpperCase","closePath","fillRect","i","font","toString","forEach","item","save","rect","fill","restore","arc","PI","scale","translate","drawCanvas","drawPointer","drawShapes","OVERLAY_ID","OldModule","module","bundle","Module","moduleName","call","hot","data","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","JSON","parse","handled","assets","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","id","every","generated","js","hmrApply","v","hmrAcceptRun","reload","close","onclose","removeErrorOverlay","error","message","stack","overlay","createErrorOverlay","body","appendChild","remove","createElement","stackTrace","innerText","innerHTML","getParents","modules","parents","k","d","dep","Array","isArray","concat","Function","deps","cached","cache","some","cb"],"mappings":"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","file":"app.a6a4d504.js","sourceRoot":"..","sourcesContent":["export const CANVAS_DIMENSIONS = {\r\n    WIDTH: 4000,\r\n    HEIGHT: 3000\r\n}\r\n\r\nexport const SNAP_GRID = {\r\n    'XS': 10,\r\n    'S': 20,\r\n    'M': 25,\r\n    'L': 50\r\n};\r\n\r\nexport const OPERATIONS = {\r\n    // view\r\n    PAN: \"PAN\",\r\n    ZOOM: \"ZOOM\",\r\n    SELECT: \"SELECT\",\r\n    DELETE: \"DELETE\",\r\n    // MODIFICA\r\n    MOVE: 'MOVE',\r\n    ROTATE: \"ROTATE\",\r\n    PULL: \"PULL\",\r\n    SCALE: 'SCALE',\r\n    COPY: 'COPY',\r\n    // SHAPES\r\n    LINE: 'LINE',\r\n    RECT: 'RECT',\r\n    CIRCLE: 'CIRCLE',\r\n    ARC: 'ARC',\r\n    // STYLE\r\n    FILL: 'FILL'\r\n};\r\n\r\nexport const COLORS = {\r\n    shapes_fill: 'rgba(0,190,0,0.35)',\r\n    shapes_stroke: 'white'\r\n}","import { OPERATIONS, SNAP_GRID } from './constants';\n\n// https://css-tricks.com/snippets/javascript/javascript-keycodes/\nexport default class KeyboardEvents {\n\n    constructor(main) {\n\n        this.main = main;\n        // DEFAULTS\n        this.choosenCommand = OPERATIONS.SELECT\n        this.currentSnap = SNAP_GRID.M;\n        this.hasSnap = true;\n\n        this.startListenDocumentKeyup()\n    }\n\n    startListenDocumentKeyup() {\n        document.onkeyup = (e) => {\n            if (e.key == 'Escape' || e.key == 's') {\n                this.choosenCommand = OPERATIONS.SELECT;\n                /* } else if (e.key == 'd') {\n                    this.choosenCommand = OPERATIONS.DELETE;\n                } else if (e.key == 'c') {\n                    this.choosenCommand = OPERATIONS.COPY;\n                } else if (e.key == 'm') {\n                    this.choosenCommand = OPERATIONS.MOVE;\n                } else if (e.key == 'r') {\n                    this.choosenCommand = OPERATIONS.ROTATE;\n                } else if (e.key == 'p') {\n                    this.choosenCommand = OPERATIONS.PULL;\n                } else if (e.key == 's') {\n                    this.choosenCommand = OPERATIONS.SCALE;\n                } else if (e.key == 'l') {\n                    this.choosenCommand = OPERATIONS.LINE;\n                } else if (e.key == 'q') {\n                    this.choosenCommand = OPERATIONS.RECT;\n                } else if (e.key == 'o') {\n                    this.choosenCommand = OPERATIONS.CIRCLE;\n                } else if (e.key == 'a') {\n                    this.choosenCommand = OPERATIONS.ARC;\n                } else if (e.key == 'f') {\n                    this.choosenCommand = OPERATIONS.FILL; */\n            } else if (e.key == 'l') {\n                this.choosenCommand = OPERATIONS.LINE;\n            } else if (e.key == 'r') {\n                this.choosenCommand = OPERATIONS.RECT;\n            } else if (e.key == 'c') {\n                this.choosenCommand = OPERATIONS.CIRCLE;\n            } else if (e.key == 'p') {\n                this.choosenCommand = OPERATIONS.PAN;\n            } else if (e.key == 0) {\n                this.hasSnap = false;\n            } else if (e.key == \"1\") {\n                this.hasSnap = true;\n                this.currentSnap = SNAP_GRID.L\n            } else if (e.key == \"2\") {\n                this.hasSnap = true;\n                this.currentSnap = SNAP_GRID.M\n            } else if (e.key == \"3\") {\n                this.hasSnap = true;\n                this.currentSnap = SNAP_GRID.S\n            } else if (e.key == \"4\") {\n                this.hasSnap = true;\n                this.currentSnap = SNAP_GRID.XS\n            } else if (e.ctrlKey && e.key == 'z') {\n                // alert(\"Ctrl + Z shortcut combination was pressed\");\n                this.main.HM.undo()\n            } else if (e.ctrlKey && e.key == 'y') {\n                // alert(\"Ctrl + Y shortcut combination was pressed\");\n                this.main.HM.redo()\n            }\n        }\n    }\n}","export default class HistoryManagement {\r\n\r\n    constructor(main) {\r\n        this.main = main\r\n        this.history = [[]];\r\n        this.position = 0;\r\n    }\r\n\r\n    get value () {\r\n        return this.history[this.position];\r\n    }\r\n\r\n    set (value) {\r\n        if (this.position < this.history.length - 1) {\r\n            this.history = this.history.slice(0, this.position + 1);\r\n        }\r\n        this.history.push([...value]);\r\n        this.position += 1;\r\n    }\r\n    \r\n    undo () {\r\n        if (this.position > 0) {\r\n            this.position--;\r\n            this.main.shapes = [...this.value];\r\n        } else {\r\n            console.log('No more undo ...')\r\n        }\r\n    }\r\n    \r\n    redo () {\r\n        if (this.position < this.history.length - 1) {\r\n            this.position++;\r\n            this.main.shapes = [...this.value];\r\n        } else {\r\n            console.log('No more redo ...')\r\n        }\r\n    }\r\n\r\n    // toString function to aid in illustrating\r\n    toString () {\r\n        console.log(\"Currnent Value: \", this.value)\r\n        console.log(\"History: \", this.history)\r\n        console.log(\"Position: \", this.position);\r\n    }\r\n}\r\n","export default class Command {\r\n\r\n    constructor(main){\r\n        // ref to main class istance\r\n        this.main = main;\r\n    }\r\n\r\n}","import Command from './command';\r\n\r\nexport default class PanCommand extends Command {\r\n\r\n    constructor(state) {\r\n        super(state)\r\n\r\n        // this.mouse drag related variables\r\n        this.isDown = false;\r\n        this.startX, this.startY;\r\n\r\n        // the accumulated horizontal(X) & vertical(Y) panning the user has done in total\r\n        this.main.netPanningX = 0;\r\n        this.main.netPanningY = 0;\r\n    }\r\n\r\n    mousemove(e) {\r\n\r\n        // tell the browser we're handling this event\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n\r\n        let x = e._x;\r\n        let y = e._y;\r\n\r\n        // if the this.mouse is being dragged\r\n        if (this.isDown) {\r\n            // dx & dy are the distance the this.mouse has moved since the last this.mousemove event\r\n            var dx = x - this.startX;\r\n            var dy = y - this.startY;\r\n\r\n            // reset the vars for next this.mousemove\r\n            this.startX = x;\r\n            this.startY = y;\r\n\r\n            // accumulate the net panning done\r\n            this.main.netPanningX += dx;\r\n            this.main.netPanningY += dy;\r\n            console.clear()\r\n            console.log(`Net change in panning: x:${this.main.netPanningX}px, y:${this.main.netPanningY}px`);\r\n        }\r\n        this.main.mouse.x = x;\r\n        this.main.mouse.y = y;\r\n        this.main.mouse.event = e;\r\n    }\r\n\r\n    mousedown(e) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n\r\n        // calc the starting this.mouse X,Y for the drag\r\n        this.startX = e._x;\r\n        this.startY = e._y;\r\n\r\n        // set the isDragging flag\r\n        this.isDown = true;\r\n    }\r\n\r\n    mouseup(e) {\r\n        console.log('PanCommand: mouseup', e, this)\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        // clear the isDragging flag\r\n        this.isDown = false;\r\n    }\r\n\r\n    mouseout(e) {\r\n        console.log('PanCommand: mouseout', e, this)\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        // clear the isDragging flag\r\n        this.isDown = false;\r\n    }\r\n\r\n}","import Command from './command';\r\n\r\nexport default class SelectCommand extends Command {\r\n\r\n    constructor(state) {\r\n        super(state)\r\n    }\r\n\r\n    mousemove(e) {\r\n        // console.log('SelectCommand: mousemove', e, this)\r\n        this.main.mouse.x = e._x;\r\n        this.main.mouse.y = e._y;\r\n        this.main.mouse.event = e;\r\n    }\r\n\r\n    mousedown(e) {\r\n        // console.log('SelectCommand: mousedown', e, this)\r\n    }\r\n\r\n    mouseup(event) {\r\n        // console.log('SelectCommand: mouseup', event, this)\r\n    }\r\n\r\n    mouseout(event) {\r\n        // console.log('SelectCommand: mouseout', event, this)\r\n    }\r\n\r\n}","import Command from './command';\r\n\r\nimport { COLORS } from '../constants';\r\n\r\nexport default class LineCommand extends Command {\r\n\r\n    constructor(state) {\r\n        super(state)\r\n        this.started = false;\r\n        this.start = {}\r\n    }\r\n\r\n    mousemove(event) {\r\n        this.main.mouse.x = event._x;\r\n        this.main.mouse.y = event._y;\r\n        this.main.mouse.event = event;\r\n\r\n        if (this.started) {\r\n            this.main.tempShape = [{\r\n                start_x: this.start.x,\r\n                start_y: this.start.y,\r\n                end_x: event._x - this.main.netPanningX,\r\n                end_y: event._y - this.main.netPanningY\r\n            }]\r\n\r\n        }\r\n    }\r\n\r\n    mousedown(event) {\r\n        /*         this.main.ctx.beginPath(); */\r\n        this.start.x = event._x - this.main.netPanningX;\r\n        this.start.y = event._y - this.main.netPanningY;\r\n        this.started = true;\r\n    }\r\n\r\n    mouseup(event) {\r\n        if (this.started) {\r\n            this.started = false;\r\n            this.main.tempShape.length = 0;\r\n            this.main.shapes.push({\r\n                start_x: this.start.x,\r\n                start_y: this.start.y,\r\n                end_x: event._x - this.main.netPanningX,\r\n                end_y: event._y - this.main.netPanningY,\r\n                color: COLORS.shapes_stroke\r\n            });\r\n            this.main.HM.set(this.main.shapes)\r\n        }\r\n    }\r\n\r\n    mouseout(event) {\r\n        if (this.started) {\r\n            this.started = false;\r\n            this.main.tempShape.length = 0;\r\n            this.main.shapes.push({\r\n                start_x: this.start.x,\r\n                start_y: this.start.y,\r\n                end_x: event._x - this.main.netPanningX,\r\n                end_y: event._y - this.main.netPanningY,\r\n                color: COLORS.shapes_stroke\r\n            });\r\n            this.main.HM.set(this.main.shapes)\r\n        }\r\n    }\r\n\r\n}","import Command from './command';\r\n\r\nimport { COLORS } from '../constants';\r\n\r\nexport default class RectCommand extends Command {\r\n\r\n    constructor(state) {\r\n        super(state)\r\n        this.started = false;\r\n        this.start = {}\r\n        this.x, this.y\r\n        this.width, this.height\r\n    }\r\n\r\n    mousemove(event) {\r\n        this.main.mouse.x = event._x;\r\n        this.main.mouse.y = event._y;\r\n        this.main.mouse.event = event;\r\n\r\n        if (this.started) {\r\n            this.x = Math.min(event._x, this.start.x),\r\n                this.y = Math.min(event._y, this.start.y),\r\n                this.w = Math.abs(event._x - this.start.x),\r\n                this.h = Math.abs(event._y - this.start.y);\r\n            if (!this.w || !this.h) {\r\n                return;\r\n            }\r\n            this.main.tempShape = [{\r\n                x: this.x - this.main.netPanningX,\r\n                y: this.y - this.main.netPanningY,\r\n                w: this.w,\r\n                h: this.h\r\n            }]\r\n        }\r\n\r\n    }\r\n\r\n    mousedown(event) {\r\n        this.main.ctx.beginPath();\r\n        this.start.x = event._x;\r\n        this.start.y = event._y;\r\n        this.started = true;\r\n    }\r\n\r\n    mouseup(event) {\r\n        if (this.started) {\r\n            this.started = false;\r\n            this.main.tempShape.length = 0;\r\n            this.main.shapes.push({\r\n                x: this.x - this.main.netPanningX,\r\n                y: this.y - this.main.netPanningY,\r\n                w: this.w,\r\n                h: this.h,\r\n                color: COLORS.shapes_fill,\r\n                stroke: COLORS.shapes_stroke\r\n            });\r\n            this.main.HM.set(this.main.shapes)\r\n        }\r\n    }\r\n\r\n    mouseout(event) {\r\n        if (this.started) {\r\n            this.started = false;\r\n            this.main.tempShape.length = 0;\r\n            this.main.shapes.push({\r\n                x: this.x - this.main.netPanningX,\r\n                y: this.y - this.main.netPanningY,\r\n                w: this.w,\r\n                h: this.h,\r\n                color: COLORS.shapes_fill,\r\n                stroke: COLORS.shapes_stroke\r\n            });\r\n            this.main.HM.set(this.main.shapes)\r\n        }\r\n    }\r\n\r\n}","import Command from './command';\r\n\r\nimport { COLORS } from '../constants';\r\n\r\nexport default class CircleCommand extends Command {\r\n\r\n    constructor(state) {\r\n        super(state)\r\n        this.started = false;\r\n        this.start = {}\r\n        this.radius = 0\r\n    }\r\n\r\n    mousemove(event) {\r\n        this.main.mouse.x = event._x;\r\n        this.main.mouse.y = event._y;\r\n        this.main.mouse.event = event;\r\n\r\n        if (this.started) {\r\n            let dx = this.start.x - (event._x - this.main.netPanningX);\r\n            let dy = this.start.y - (event._y - this.main.netPanningY);\r\n            this.radius = Math.sqrt(dx * dx + dy * dy);\r\n            this.main.tempShape = [{\r\n                start_x: this.start.x,\r\n                start_y: this.start.y,\r\n                radius: this.radius\r\n            }]\r\n        }\r\n    }\r\n\r\n    mousedown(event) {\r\n        /* this.main.ctx.beginPath(); */\r\n        this.start.x = event._x - this.main.netPanningX;\r\n        this.start.y = event._y - this.main.netPanningY;\r\n        this.started = true;\r\n    }\r\n\r\n    mouseup(event) {\r\n        if (this.started) {\r\n            this.started = false;\r\n            this.main.tempShape.length = 0;\r\n            this.main.shapes.push({\r\n                start_x: this.start.x,\r\n                start_y: this.start.y,\r\n                radius: this.radius,\r\n                color: COLORS.shapes_fill,\r\n                stroke: COLORS.shapes_stroke\r\n            });\r\n            this.main.HM.set(this.main.shapes)\r\n            this.radius = 0;\r\n        }\r\n    }\r\n\r\n    mouseout(event) {\r\n        if (this.started) {\r\n            this.started = false;\r\n            this.main.tempShape.length = 0;\r\n            this.main.shapes.push({\r\n                start_x: this.start.x,\r\n                start_y: this.start.y,\r\n                radius: this.radius,\r\n                color: COLORS.shapes_fill,\r\n                stroke: COLORS.shapes_stroke\r\n            });\r\n            this.main.HM.set(this.main.shapes)\r\n            this.radius = 0;\r\n        }\r\n    }\r\n\r\n}","import KeyboardEvents from './keyboards_events';\r\nimport HistoryManagement from './history_management';\r\n\r\nimport { CANVAS_DIMENSIONS } from './constants';\r\n\r\n// Commands\r\nimport PanCommand from './commands/pan';\r\nimport SelectCommand from './commands/select';\r\nimport LineCommand from './commands/line';\r\nimport RectCommand from './commands/rect';\r\nimport CircleCommand from './commands/circle';\r\n\r\nwindow.onload = () => {\r\n    const cad = new WebCAD();\r\n    document.getElementById('canvas').replaceWith(cad.canvas);\r\n    cad.start();\r\n    window.cad = cad;\r\n}\r\n\r\nexport class WebCAD {\r\n\r\n    constructor() {\r\n        this.canvas = document.getElementById(\"canvas\");\r\n        this.ctx = canvas.getContext('2d');\r\n        this.keys = new KeyboardEvents(this);\r\n        \r\n        this.commands = {\r\n            'PAN': new PanCommand(this),\r\n            'SELECT': new SelectCommand(this),\r\n            'LINE': new LineCommand(this),\r\n            'RECT': new RectCommand(this),\r\n            'CIRCLE': new CircleCommand(this)\r\n        }\r\n        \r\n        this.mouse = {\r\n            x: 0,\r\n            y: 0,\r\n            event: null\r\n        };\r\n        \r\n        this.shapes = [];\r\n        this.tempShape = []\r\n        this.HM = new HistoryManagement(this);\r\n\r\n        this.startListening()\r\n        this.resizeCanvas()\r\n    }\r\n\r\n    resizeCanvas() {\r\n        this.canvas.width = window.innerWidth;\r\n        this.canvas.height = window.innerHeight;\r\n        this.canvas.style.cursor = \"none\"\r\n        this.drawAll();\r\n    }\r\n\r\n    startListening() {\r\n        // resize the canvas to fill browser window dynamically\r\n        window.addEventListener('resize', this.resizeCanvas.bind(this), false);\r\n\r\n        this.canvas.addEventListener('mousemove', this.globalHandler.bind(this), false);\r\n        this.canvas.addEventListener('mousedown', this.globalHandler.bind(this), false);\r\n        this.canvas.addEventListener('mouseup', this.globalHandler.bind(this), false);\r\n        this.canvas.addEventListener('mouseout', this.globalHandler.bind(this), false);\r\n    }\r\n\r\n    globalHandler(ev) {\r\n        this.currentCommand = this.commands[this.keys.choosenCommand]\r\n        let x = parseInt(ev.clientX);\r\n        let y = parseInt(ev.clientY);\r\n\r\n        /* ----------------- SNAP 2 GRID ----------------- */\r\n        if (this.keys.hasSnap) {\r\n            let restoH = x % this.keys.currentSnap;\r\n            if (restoH >= this.keys.currentSnap) {\r\n                x = x - restoH + this.keys.currentSnap\r\n            } else {\r\n                x -= restoH;\r\n            }\r\n            let restoV = y % this.keys.currentSnap;\r\n            if (restoV >= this.keys.currentSnap) {\r\n                y = y - restoV + this.keys.currentSnap\r\n            } else {\r\n                y -= restoV;\r\n            }\r\n        }\r\n        ev._x = x;\r\n        ev._y = y;\r\n\r\n        var func = this.currentCommand[ev.type].bind(this.currentCommand);\r\n        if (func) {\r\n            func(ev);\r\n        }\r\n    }\r\n\r\n    loop() {\r\n        this.drawAll();\r\n        requestAnimationFrame(() => {\r\n            this.loop()\r\n        });\r\n    }\r\n\r\n    start() {\r\n        this.loop();\r\n    }\r\n\r\n    /* --------------------------------------------------------- */\r\n\r\n    drawPointer() {\r\n        this.ctx.strokeStyle = \"rgb(0,103,28)\"; // green\r\n        this.ctx.strokeRect(this.mouse.x - 4.5 - this.netPanningX, this.mouse.y - 5.5 - this.netPanningY, 10, 10);\r\n        this.ctx.lineWidth = 0.5;\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(this.mouse.x - this.netPanningX, 0);\r\n        this.ctx.lineTo(this.mouse.x - this.netPanningX, CANVAS_DIMENSIONS.HEIGHT);\r\n        this.ctx.moveTo(0, this.mouse.y - this.netPanningY);\r\n        this.ctx.lineTo(CANVAS_DIMENSIONS.WIDTH, this.mouse.y - this.netPanningY);\r\n        this.ctx.stroke();\r\n        this.ctx.fillStyle = \"grey\";\r\n        this.ctx.fillText(`${this.keys.choosenCommand.toUpperCase()}`, this.mouse.x + 12.5 - this.netPanningX, this.mouse.y - 4.5 - this.netPanningY)\r\n        this.ctx.fillText(`x: ${this.mouse.x - this.netPanningX} - y: ${this.mouse.y - this.netPanningY}`, this.mouse.x + 12.5 - this.netPanningX, this.mouse.y + 12.5 - this.netPanningY)\r\n        this.ctx.closePath();\r\n    }\r\n\r\n    drawCanvas() {\r\n        this.ctx.fillStyle = \"rgb(31,40,49)\";\r\n        this.ctx.fillRect(0, 0, CANVAS_DIMENSIONS.WIDTH, CANVAS_DIMENSIONS.HEIGHT);\r\n        // colonne\r\n        for (let i = 0; i < CANVAS_DIMENSIONS.WIDTH; i += this.keys.currentSnap) {\r\n            if (this.keys.hasSnap) {\r\n                this.ctx.beginPath();\r\n                this.ctx.moveTo(i + 0.5, 0);\r\n                this.ctx.lineTo(i + 0.5, CANVAS_DIMENSIONS.HEIGHT);\r\n                if (i % 100 === 0) {\r\n                    this.ctx.strokeStyle = \"rgb(48,55,71)\";\r\n                } else {\r\n                    this.ctx.strokeStyle = \"rgb(36,45,56)\";\r\n                }\r\n                this.ctx.lineWidth = 0.5;\r\n                this.ctx.closePath()\r\n                this.ctx.stroke();\r\n            }\r\n            if (i % 100 === 0) {\r\n                this.ctx.font = \"11px Arial\";\r\n                this.ctx.fillStyle = \"grey\";\r\n                // this.ctx.textAlign = \"center\";\r\n                this.ctx.fillText(i.toString(), i + 2.5, 10 - (this.netPanningY > 0 ? 0 : this.netPanningY));\r\n            }\r\n        }\r\n        // righe\r\n        for (let i = 0; i < CANVAS_DIMENSIONS.HEIGHT; i += this.keys.currentSnap) {\r\n            if (this.keys.hasSnap) {\r\n                this.ctx.beginPath();\r\n                this.ctx.moveTo(0, i + 0.5);\r\n                this.ctx.lineTo(CANVAS_DIMENSIONS.WIDTH, i + 0.5);\r\n                if (i % 100 === 0) {\r\n                    this.ctx.strokeStyle = \"rgb(48,55,71)\";\r\n                } else {\r\n                    this.ctx.strokeStyle = \"rgb(36,45,56)\";\r\n                }\r\n                this.ctx.lineWidth = 0.5;\r\n                this.ctx.closePath()\r\n                this.ctx.stroke();\r\n            }\r\n            if (i % 100 === 0) {\r\n                this.ctx.font = \"11px Arial\";\r\n                this.ctx.fillStyle = \"grey\";\r\n                // this.ctx.textAlign = \"center\";\r\n                this.ctx.fillText(i.toString(), 2.5 - (this.netPanningX > 0 ? 0 : this.netPanningX), i - 2.5);\r\n            }\r\n        }\r\n    }\r\n\r\n    drawShapes() {\r\n        [...this.HM.value, ...this.tempShape].forEach(item => {\r\n            if (item.w) {\r\n                this.ctx.save()\r\n                this.ctx.fillStyle = item.color\r\n                this.ctx.strokeStyle = item.stroke\r\n                this.ctx.beginPath()\r\n                this.ctx.rect(item.x, item.y, item.w, item.h)\r\n                this.ctx.fill()\r\n                this.ctx.stroke()\r\n                this.ctx.restore()\r\n            } else if (item.radius) {\r\n                this.ctx.save()\r\n                this.ctx.strokeStyle = item.stroke\r\n                this.ctx.fillStyle = item.color\r\n                // x, y, radius, startAngle, endAngle, antiClockwise = false by default\r\n                this.ctx.beginPath()\r\n                this.ctx.arc(item.start_x, item.start_y, item.radius, 0, 2 * Math.PI, false) // full circle\r\n                this.ctx.fill()\r\n                this.ctx.stroke()\r\n                this.ctx.restore()\r\n            } else {\r\n                this.ctx.save()\r\n                this.ctx.strokeStyle = item.color;\r\n                this.ctx.beginPath()\r\n                this.ctx.moveTo(item.start_x, item.start_y) // sets our starting point\r\n                this.ctx.lineTo(item.end_x, item.end_y) // create a line from start point to X: 100, Y: 200\r\n                this.ctx.closePath() // left side and closes the pat\r\n                this.ctx.stroke()\r\n                this.ctx.restore()\r\n            }\r\n        });\r\n    }\r\n\r\n    drawAll() {\r\n        // this.ctx.fillStyle = \"black\";\r\n        this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height); // CANVAS_DIMENSIONS.WIDTH, CANVAS_DIMENSIONS.HEIGHT\r\n        this.ctx.save();\r\n        this.ctx.scale(1, 1 /* this.viewport.scale[0], this.viewport.scale[1] */); // apply scale\r\n        this.ctx.translate(this.netPanningX, this.netPanningY); // apply translation\r\n        this.drawCanvas();\r\n        this.drawPointer();\r\n        this.drawShapes();\r\n        this.ctx.restore();\r\n    }\r\n\r\n}\r\n\r\n\r\n\r\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel] ✨ Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel] 🚨  ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\">🚨</span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}